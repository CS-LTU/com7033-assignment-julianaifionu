{% extends "base.html" %} {% block title %}Patient Details{% endblock %} {%
block content %}
<div class="container mt-4 mb-5" style="max-width: 900px">
	<div
		class="d-flex justify-content-between align-items-start mb-4 p-3 rounded border bg-light"
	>
		<div>
			<h2 class="fw-bold mb-1 d-flex align-items-center">
				<i class="bi bi-person-circle me-3 text-primary"></i>
				{{ patient.first_name }} {{ patient.last_name }}
			</h2>

			{% if patient.is_archived %}
			<span class="badge bg-danger">Archived</span> {% else %}
			<span class="badge bg-success">Active</span> {% endif %}
		</div>

		{% if role_name == "clinician" and not patient.is_archived %}
		<div class="d-flex gap-2">
			<a
				href="{{ url_for('edit_patient_get', patient_id=patient.id) }}"
				class="btn btn-primary px-4"
			>
				<i class="bi bi-pencil-square me-1"></i> Edit
			</a>

			<form
				action="{{ url_for('archive_patient', patient_id=patient.id) }}"
				method="POST"
			>
				<button type="submit" class="btn btn-danger px-4">
					<i class="bi bi-archive me-1"></i> Archive
				</button>
			</form>
		</div>
		{% endif %}
	</div>
	<div class="view_patient card shadow-sm border-0 rounded-4 p-4">
		<!-- DEMOGRAPHICS -->
		<h5 class="fw-semibold mb-3">Demographic</h5>
		<div class="row mb-4">
			<div class="col-md-6 mb-2">
				<strong>Name:</strong> {{ patient.first_name }} {{ patient.last_name }}
			</div>
			<div class="col-md-6 mb-2">
				<strong>Gender:</strong> {{ patient.gender|capitalize }}
			</div>
			<div class="col-md-6 mb-2">
				<strong>Date of Birth:</strong> {{ patient.date_of_birth }}
			</div>
			<div class="col-md-6 mb-2">
				<strong>Created:</strong> {{ patient.created_at | humanize_date }}
			</div>
		</div>
		<hr />
		<!-- LIFESTYLE -->
		<h5 class="fw-semibold mb-3">Lifestyle</h5>
		{% if lifestyle %}
		<div class="row mb-4">
			<div class="col-md-6 mb-2">
				<strong>Ever Married:</strong> {{ lifestyle.ever_married|capitalize or
				"N/A" }}
			</div>
			<div class="col-md-6 mb-2">
				<strong>Work Type:</strong> {{ lifestyle.work_type|capitalize or "N/A"
				}}
			</div>
			<div class="col-md-6 mb-2">
				<strong>Resident Type:</strong> {{ lifestyle.resident_type|capitalize or
				"N/A" }}
			</div>
			<div class="col-md-6 mb-2">
				<strong>Smoking Status:</strong> {{ lifestyle.smoking_status|capitalize
				or "N/A" }}
			</div>
		</div>
		{% else %}
		<p class="text-muted">No lifestyle data available.</p>
		{% endif %}

		<hr />

		<!-- MEDICAL -->
		<h5 class="fw-semibold mb-3">Medical History</h5>

		{% if medical %}
		<div class="row mb-4">
			<div class="col-md-4 mb-2">
				<strong>Hypertension:</strong> {{ "Yes" if medical.hypertension==1 else
				"No" }}
			</div>
			<div class="col-md-4 mb-2">
				<strong>Heart Disease:</strong> {{ "Yes" if medical.heart_disease==1
				else "No" }}
			</div>
			<div class="col-md-4 mb-2">
				<strong>Stroke:</strong> {{ "Yes" if medical.stroke==1 else "No" }}
			</div>
			<div class="col-md-6 mb-2"><strong>BMI:</strong> {{ medical.bmi }}</div>
			<div class="col-md-6 mb-2">
				<strong>Avg Glucose Level:</strong> {{ medical.avg_glucose_level }}
			</div>
		</div>
		{% else %}
		<p class="text-muted">No medical history recorded.</p>
		{% endif %}
	</div>

	<div class="mt-4">
		<a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary">
			<i class="bi bi-arrow-left me-1"></i> Back to Dashboard
		</a>
	</div>
</div>

{% endblock %}
